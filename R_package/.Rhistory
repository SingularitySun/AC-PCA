which(fns=="SNEDE0000EQA.txt.gz")
which(fns=="SNEDE0000EOO.txt.gz")
hist(sumr[,i], breaks=50, xlim=c(1, 4.5), ylim=c(0, 60), main=paste("p_value <= ", pvs[i], sep=""))
abline(v = sumr[84,i])
abline(v = sumr[84,i], col=2)
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(1, 4.5), ylim=c(0, 60), main=paste("p_value <= ", pvs[i], sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
SNEDE0000EIJ.txt <- read.delim("~/Documents/datatmp/SNEDE0000EIJ.txt.gz", header=FALSE)
View(SNEDE0000EIJ.txt)
SNEDE0000EIJ.txt[1,]
SNEDE0000EIJ.txt[1,9]
nums <- c(151881, 30306, 11166, 5732, 3646, 2478, 1747, 1309, 1080, 817)
rm(SNEDE0000EIJ.txt)
gc()
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(1, 4.5), ylim=c(0, 60), main=paste("pv <= ", pvs[i], " ", nums[i],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(1, 4.5), ylim=c(0, 60), main=paste("pv <= ", pvs[i], " ", nums[i-1],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(1, 4.5), ylim=c(0, 60), main=paste("pv <= ", pvs[i], ", ", nums[i-1],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
fns[which(sumr[,8]>=3.5)]
fns[which(sumr[,8]>=3)]
fns[which(sumr[,8]>=3.2)]
hist(sumr[,3], breaks=50)
hist(sumr[,3], breaks=50)
hist(sumr[,3], breaks=50)
mean(sumr[,3])
sd(sumr[,3])
hist(sumr[,3], breaks=50, freq=F)
hist(sumr[,3], breaks=50, freq=F)
lines(density(rnorm(1000, mean=mean(sumr[,3]), sd=sd(sumr[,3]))))
hist(sumr[,3], breaks=50, freq=F)
lines(density(rnorm(10000, mean=mean(sumr[,3]), sd=sd(sumr[,3]))))
lines(density(rnorm(100000, mean=mean(sumr[,3]), sd=sd(sumr[,3]))))
hist(sumr[,4], breaks=50, freq=F)
sumr[,1]
nums[4]
nums[3]
i <- 4
hist(sumr[,i], breaks=50, freq=F)
lines(density(rnorm(100000, mean=mean(sumr[,i]), sd=sd(sumr[,i]))))
nums[7]
nums[8]
nums[9]
sds <- apply(sumr, 2, sd)
sds
sds <- sds[-1]
sds
sds <- apply(sumr, 2, sd)
sds
sds <- sds[3:11]
sds
sds <- apply(sumr, 2, sd)
sds <- sds[4:11]
sds
sn <- 1/sqrt(nums[3:10])*sqrt(nums[3])
sn
plot(sn, sds)
lines(1:5, 1:5)
plot(sn, sds/sn)
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0, 4.5), ylim=c(0, 60), main=paste("pv <= ", pvs[i], ", ", nums[i-1],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0.5, 4.5), ylim=c(0, 60), main=paste("pv <= ", pvs[i], ", ", nums[i-1],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0.5, 4.5), ylim=c(0, 60), main=paste("pv <= ", pvs[i], ", ", nums[i-1],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0, 4.5), ylim=c(0, 60), main=paste("pv <= ", pvs[i], ", ", nums[i-1],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
summary_g5 <- read.table("~/Dropbox/open_chromatin/crohn/summary_g5.txt", quote="\"", comment.char="")
View(summary_g5)
nums <- c(493976, 73246, 12614, 3167, 1391, 795, 579, 422, 338, 280, 247)
summary_g5 <- read.table("~/Dropbox/open_chromatin/crohn/summary_g5.txt", quote="\"", comment.char="")
fns <- read.table("~/Dropbox/open_chromatin/height/fns.txt", quote="\"", comment.char="")
fns <- as.vector(fns[,1])
pvs <- 10^(seq(0, -10 ,-1))
summary_g5 <- as.matrix(summary_g5)
sumr <- summary_g5/summary_g5[,1]
sumr[,11]
max(sumr)
min(sumr)
sumr[,1]
sumr[,2]
sumr[,3]
nums <- c(493976, 73246, 12614, 3167, 1391, 795, 579, 422, 338, 280, 247)
summary_g5 <- read.table("~/Dropbox/open_chromatin/crohn/summary_g5.txt", quote="\"", comment.char="")
fns <- read.table("~/Dropbox/open_chromatin/height/fns.txt", quote="\"", comment.char="")
fns <- as.vector(fns[,1])
pvs <- 10^(seq(0, -10 ,-1))
summary_g5 <- as.matrix(summary_g5)
sumr <- summary_g5/summary_g5[,1]
fns[which(sumr[,11]>=3.7)]
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0, max(sumr)), ylim=c(0, 60), main=paste("pv <= ", pvs[i], ", ", nums[i],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0, max(sumr)), ylim=c(0, 100), main=paste("pv <= ", pvs[i], ", ", nums[i],sep=""))
abline(v = sumr[84,i], col=2)
abline(v = sumr[196,i], col=3)
abline(v = sumr[167,i], col=4)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0, max(sumr)), ylim=c(0, 100), main=paste("pv <= ", pvs[i], ", ", nums[i],sep=""))
#abline(v = sumr[84,i], col=2)
#abline(v = sumr[196,i], col=3)
#abline(v = sumr[167,i], col=4)
}
par(mfrow=c(1, 1))
plot(-log10(pvs), apply(sumr, 2, median), xlab="log10(p_value) cutoff", ylab="fold change compared with all SNPs")
plot(-log10(pvs), apply(sumr, 2, mean), xlab="log10(p_value) cutoff", ylab="fold change compared with all SNPs")
par(mfrow=c(1, 1))
plot(-log10(pvs), apply(sumr, 2, median), xlab="log10(p_value) cutoff", ylab="fold change compared with all SNPs")
pvs[7]
pvs[8]
pvs[9]
pvs
fns[which(sumr[,9]>=6)]
which(fns=="SNEDE0000EJQ.txt.gz")
sumr[39,9]
sd(sumr[,6])
sd(sumr[,8])
nums[6]
nums[8]
which(fns=="SNEDE0000EQF.txt.gz")
which(fns=="SNEDE0000EQC.txt.gz")
which(fns=="SNEDE0000EQD.txt.gz")
which(fns=="SNEDE0000EQE.txt.gz")
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0, max(sumr)), ylim=c(0, 100), main=paste("pv <= ", pvs[i], ", ", nums[i],sep=""))
abline(v = sumr[201,i], col=2)
abline(v = sumr[198,i], col=3)
abline(v = sumr[199,i], col=3)
abline(v = sumr[200,i], col=3)
}
par(mfrow=c(3, 4))
for (i in 2:11){
hist(sumr[,i], breaks=50, xlim=c(0, max(sumr)), ylim=c(0, 100), main=paste("pv <= ", pvs[i], ", ", nums[i],sep=""))
abline(v = sumr[201,i], col=2)
abline(v = sumr[198,i], col=4)
abline(v = sumr[199,i], col=4)
abline(v = sumr[200,i], col=4)
}
par(mfrow=c(1, 1))
plot(-log10(pvs), apply(sumr, 2, median), xlab="log10(p_value) cutoff", ylab="fold change compared with all SNPs")
gc()
library("brainMRF", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
install_github('brainMRF','linzx06')
library("devtools", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
install_github('brainMRF','linzx06')
install_github('brainMRF','linzx06/brainMRF')
install_github("linzx06/brainMRF")
install_github("linzx06/Mouse_brain_RNAseq")
detach("package:brainMRF", unload=TRUE)
library("brainMRF", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
git
roadmap_stringent_enhancers_with_Ensembl_ID_and_name.bed <- read.delim("~/Documents/Functional_Database/enhancer/roadmap_stringent_enhancers_with_Ensembl_ID_and_name.bed.txt", header=FALSE)
View(roadmap_stringent_enhancers_with_Ensembl_ID_and_name.bed)
gc()
enhancer <- read.delim("~/Documents/Functional_Database/enhancer/roadmap_stringent_enhancers_with_Ensembl_ID_and_name.bed.txt", header=FALSE)
enhancer[1,]
enhancer[2,]
enhancer[2,4]
enhancer[2,4]=="."
enhancer[2,4]==".."
enhancer[2,4]=="."
enhancer_k <- enhancer[which(enhancer[,4]!="."),]
enhancer_nk <- enhancer[which(enhancer[,4]=="."),]
enhancer_k[1,]
enhancer_k[2,]
?save
save(enhancer_k, file="enhancer_k.rda")
save(enhancer_nk, file="enhancer_nk.rda")
result <- read.table("~/Documents/test_ld/weight1_out/result_1-22", quote="\"", comment.char="")
result3 <- read.table("~/Documents/test_ld/weight3_out/result_1-22New", quote="\"", comment.char="")
result5 <- read.table("~/Documents/test_ld/weight5_out/result_1-22New", quote="\"", comment.char="")
result3[1,]
result[1,]
plot(log10(result1[,6]), log10(result5[,6]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
result1 <- read.table("~/Documents/test_ld/weight1_out/result_1-22", quote="\"", comment.char="")
points(log10(result1[,6]), log10(result5[,6]), col="red", pch=20, cex=0.4)
result5 <- read.table("~/Documents/test_ld/weight5_out/result_1-22New", quote="\"", comment.char="")
result5[1,]
comb <- merge(result1,result5,by='V2',all.y=T)
comb
comb[1,]
comb[1,6]
comb[1,11]
comb15 <- merge(result1,result5,by='V2',all.y=T)
comb13 <- merge(result1,result3,by='V2',all.y=T)
plot(log10(comb15[,6]), log10(comb15[,11]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
plot(log10(comb13[,6]), log10(comb13[,11]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
abline(a=0,b=1,col="blue")
qchisq(0.001,1,lower.tail=F)
qchisq(0.0001,1,lower.tail=F)
qchisq(0.00001,1,lower.tail=F)
gc()
weight3 <- read.table("~/Documents/test_ld/weight3", quote="\"", comment.char="")
View(weight3)
plot(density(weight3[weight3[,3]==3,2]))
lines(density(weight3[weight3[,3]==1,2]))
plot(density(weight3[weight3[,3]==3,2]))
lines(density(weight3[weight3[,3]==1,2]), col="red")
hist(weight3[weight3[,3]==3,2], freq=F)
hist(weight3[weight3[,3]==3,2], freq=F, breaks=100)
hist(weight3[weight3[,3]==3,1], freq=F, breaks=100, add=T, col="red")
hist(weight3[weight3[,3]==3,2], freq=F, breaks=100)
hist(weight3[weight3[,3]==1,2], freq=F, breaks=100, add=T, col="red")
hist(log10(weight3[weight3[,3]==3,2]), freq=F, breaks=100)
hist(log10(weight3[weight3[,3]==1,2]), freq=F, breaks=100, add=T, col="red")
hist(weight3[weight3[,3]==3,2], freq=F, breaks=100)
hist(weight3[weight3[,3]==1,2], freq=F, breaks=100, add=T, col="red")
hist(weight3[weight3[,3]==3,2], freq=F, breaks=200)
hist(weight3[weight3[,3]==1,2], freq=F, breaks=200, add=T, col="red")
hist(weight3[weight3[,3]==3,2], freq=F, breaks=200)
hist(weight3[weight3[,3]==3,2], freq=F, breaks=300)
hist(weight3[weight3[,3]==3,2], freq=F, breaks=1000)
hist(weight3[weight3[,3]==3,2], freq=F, breaks=100)
hist(weight3[weight3[,3]==1,2], freq=F, breaks=100, add=T, col="red")
hist(weight3[weight3[,3]==3,2], freq=F, breaks=100)
hist(weight3[weight3[,3]==1,2], freq=F, breaks=100, add=T, col="red")
hist(weight3[weight3[,3]==3,2], freq=F, breaks=100)
hist(weight3[weight3[,3]==3,2], freq=F, breaks=100)
hist(weight3[weight3[,3]==1,2], freq=F, breaks=100, add=T, col="red")
library(SKAT)
SKAT:::SKAT_davies(5,3:1, acc=10^(-6))[[3]]
SKAT:::SKAT_davies(10,2*(3:1), acc=10^(-6))[[3]]
result1 <- read.table("~/Documents/test_ld/weight1_out/result_1-22", quote="\"", comment.char="")
result5New <- read.table("~/Documents/test_ld/weight5_out/result_1-22New", quote="\"", comment.char="")
result5 <- read.table("~/Documents/test_ld/weight5_out/result_1-22", quote="\"", comment.char="")
points(log10(result1[,6]), log10(result5[,6]), col="red", pch=20, cex=0.4)
plot(log10(result1[,6]), log10(result5[,6]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
plot(log10(result1[,6]), log10(result5New[,6]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
abline(a=0,b=1,col="blue")
result1[1,]
result5 <- result5New
openh <- as.vector(result1[result1[,6] > result5[,6] & result1[,6]<10^-4 & result5[,6]<10^-4, 2])
openl <- as.vector(result1[result1[,6] < result5[,6] & result1[,6]<10^-4 & result5[,6]<10^-4, 2])
sum(result5[,6]<10^-4)
sum(result1[,6]<10^-4)
openh <- as.vector(result1[result1[,6] > result5[,6] & result5[,6]<10^-4, 2])
openl <- as.vector(result1[result1[,6] < result5[,6] & result1[,6]<10^-4, 2])
sum(result5[,6]<10^-4)
sum(result1[,6]<10^-4)
for (g in openh){print(g)}
for (g in openl){print(g)}
openh <- as.vector(result1[result1[,6] > result5[,6] & result5[,6]<10^-5, 2])
openl <- as.vector(result1[result1[,6] < result5[,6] & result1[,6]<10^-5, 2])
openh <- as.vector(result1[result1[,6] > result5[,6] & result5[,6]<10^-6, 2])
openl <- as.vector(result1[result1[,6] < result5[,6] & result1[,6]<10^-6, 2])
result1[1,6]
openh <- as.vector(result1[result1[,6] > result5[,6] & result5[,6]<10^-6, 2])
openl <- as.vector(result1[result1[,6] < result5[,6] & result1[,6]<10^-6, 2])
result1
result1[1,]
plot(log10(result1[,6]), log10(result5[,6]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
abline(a=0,b=1,col="blue")
abline(h=-4,col="green")
abline(v=-4,col="green")
openh <- result5[result1[,6] > result5[,6] & result5[,6]<10^-6, c(2, 6)]
openl <- result1[result1[,6] < result5[,6] & result1[,6]<10^-6, c(2, 6)]
openh
openh <- result5[result1[,6] > result5[,6] & result5[,6]<10^-4, c(2, 6)]
openl <- result1[result1[,6] < result5[,6] & result1[,6]<10^-4, c(2, 6)]
openh
?order
openh <- openh[order(openh[,2]),]
openh
openh <- openh[order(openh[,2]),]
openl <- openl[order(openl[,2]),]
openh
openl
for (g in openh[,1]){print(g)}
openl[1:4,]
for (g in openl[,1]){print(g)}
g1 <- result1[result5[,6]>10^-4 & result1[,6]<10^-4, 2]
g1
g1 <- as.vector(result1[result5[,6]>10^-4 & result1[,6]<10^-4, 2])
g5 <- as.vector(result1[result1[,6]>10^-4 & result5[,6]<10^-4, 2])
g5
g1
for (g in g1){print(g)}
for (g in g5){print(g)}
g1 <- as.vector(result1[result5[,6]>0.5*10^-4 & result1[,6]<0.5*10^-4, 2])
g5 <- as.vector(result1[result1[,6]>0.5*10^-4 & result5[,6]<0.5*10^-4, 2])
g1 <- as.vector(result1[result5[,6]>0.5*10^-4 & result1[,6]<0.5*10^-4, 2])
g5 <- as.vector(result1[result1[,6]>0.5*10^-4 & result5[,6]<0.5*10^-4, 2])
sum(result1[,6]<0.5*10^-4)
sum(result5[,6]<0.5*10^-4)
tmp1 <- as.vector(result1[result1[,6]<0.5*10^-4,2])
tmp5 <- as.vector(result5[result5[,6]<0.5*10^-4,2])
length(unique(c(tmp1, tmp5)))
369 + 356 - 386
result5 <- read.table("~/Documents/test_ld/weight5_out/result_1-22", quote="\"", comment.char="")
sum(result5[,6]<0.5*10^-4)
result3New <- read.table("~/Documents/test_ld/weight3_out/result_1-22New", quote="\"", comment.char="")
sum(result3New[,6]<=10^-4)
sum(result3New[,6]<=10^-4)
sum(result5New[,6]<=10^-4)
sum(result1[,6]<=10^-4)
plot(log10(result1[,6]), log10(result3New[,6]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
result3[1,]
result3New[1,]
result3New[2,]
result3New[1,2]
34564/2
result3New[17284,2]
result3New[17283,2]
result3New[17282,2]
sum(result3New[17282:34564,6]<10^-4)
sum(result5New[17282:34564,6]<10^-4)
sum(result5New[,6]<10^-4)
sum(result1[,6]<10^-4)
result3New <- read.table("~/Documents/test_ld/weight3_out/result_1-22New", quote="\"", comment.char="")
sum(result3New[,6]<=10^-4)
sum(result5New[,6]<=10^-4)
sum(result1[,6]<=10^-4)
sum(result1[,6]<10^-4)
result1 <- read.table("~/Documents/test_ld/weight1_out/result_1-22", quote="\"", comment.char="")
sum(result1[,6]<10^-4)
plot(log10(result1[,6]), log10(result3New[,6]), xlim=c(-10, 0), ylim=c(-10, 0), cex=0.4, pch=20)
points(log10(result1[,6]), log10(result5New[,6]), col="red", pch=20, cex=0.4)
abline(a=0,b=1,col="blue")
plot(log10(result1[,6]), log10(result3New[,6]), xlim=c(-14, 0), ylim=c(-14, 0), cex=0.4, pch=20)
points(log10(result1[,6]), log10(result5New[,6]), col="red", pch=20, cex=0.4)
sum(result1[,6]<0.5*10^-4)
sum(result3New[,6]<0.5*10^-4)
sum(result5New[,6]<0.5*10^-4)
belgeim5_out <- read.table("~/Documents/test_ld/belgeim5_out", quote="\"", comment.char="")
View(belgeim5_out)
weight1_new_out <- read.table("~/Documents/test_ld/weight1_new_out", quote="\"", comment.char="")
View(weight1_new_out)
belge1_new_out <- read.table("~/Documents/test_ld/belge1_new_out", quote="\"", comment.char="")
View(belge1_new_out)
germanim5_out <- read.table("~/Documents/test_ld/germanim5_out", quote="\"", comment.char="")
View(germanim5_out)
wtcccim5_out <- read.table("~/Documents/test_ld/wtcccim5_out", quote="\"", comment.char="")
View(wtcccim5_out)
wtccc1_new_out <- read.table("~/Documents/test_ld/wtccc1_new_out", quote="\"", comment.char="")
View(wtccc1_new_out)
german1_new_out <- read.table("~/Documents/test_ld/german1_new_out", quote="\"", comment.char="")
View(german1_new_out)
sum(belge1_new_out[,6]<=0.5*10^-4)
sum(belgeim5_out[,6]<=0.5*10^-4)
sum(weight1_new_out[which(belgeim5_out[,6]<=0.5*10^-4), 6]<=0.5*10^-4)
sum(weight1_new_out[which(belge1_new_out[,6]<=0.5*10^-4), 6]<=0.5*10^-4)
sum(german1_new_out[,6]<=0.5*10^-4)
sum(weight1_new_out[which(german1_new_out[,6]<=0.5*10^-4), 6]<=0.5*10^-4)
sum(germanim5_out[,6]<=0.5*10^-4)
sum(weight1_new_out[which(germanim5_out[,6]<=0.5*10^-4), 6]<=0.5*10^-4)
sum(wtccc1_new_out[,6]<=0.5*10^-4)
sum(weight1_new_out[which(wtccc1_new_out[,6]<=0.5*10^-4), 6]<=0.5*10^-4)
sum(wtcccim5_out[,6]<=0.5*10^-4)
sum(weight1_new_out[which(wtcccim5_out[,6]<=0.5*10^-4), 6]<=0.5*10^-4)
wtccc1_new_out[1,]
wtcccim5_out[1,]
sum(wtccc1_new_out[,6]<=0.5*10^-4)
sum(weight1_new_out[,6]<=0.5*10^-4)
weightim5_out <- read.table("~/Documents/test_ld/weightim5_out", quote="\"", comment.char="")
View(weightim5_out)
sum(weightim5_out[,6]<=0.5*10^-4)
g1 <- which(weight1_new_out[,6]<=0.5*10^-4)
g5 <- which(weightim5_out[,6]<=0.5*10^-4)
length(unique(c(g1))) + length(unique(c(g5))) - length(unique(c(g1, g5)))
library("brainMRF", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
getpedgeR
brainMRF:::getpedgeR()
brainMRF:::getpedgeR
library(brainMRF)
getMRFDE
setwd("/Users/zhixiang/AC-PCA/R_package/")
?
?
help
?optimize
+Inf
c(0, Inf)
optimize(function(x){(x-300)^2}, interval=c(10^(-20), Inf))$minimum
optimize(function(x){(x-300)^2}, interval=c(10^(-20), 10^20))$minimum
?lgamma
phi
lgamma(20)
library("acPCA", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
data(data_example1)
X <- data_example1$X ###the data matrix
rm(data_example1)
library(acPCA)
library("acPCA", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
data(data_fly_worm )
names(data_fly_worm)
library(acPCA)
data(data_example1)
X <- data_example1$X ###the data matrix
dim(X)
Y <- data_example1$Y ###the confounder matrix
Y
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
###run with the best lambda
result <- acPCA(X, Y, lambda=result_cv$best_lambda, kernel="linear", nPC=2)
###the signs of the PCs are meaningless
plot(-result$Xv[,1], -result$Xv[,2], xlab="PC 1", ylab="PC 2",
col="black", type="n", main="AC-PCA, linear kernel")
text(-result$Xv[,1], -result$Xv[,2], labels = data_example1$lab,
col=data_example1$colors+1)
acPCAcv
result <- acPCA(X, Y, lambda=1, kernel="linear", nPC=2)
detach("package:acPCA", unload=TRUE)
?eigs_sym
a = matrix(1:60, nrow=10)
a
apply(a, 2, sum)
a = 1:6
b = 6:1
b
a
a > b
(a > b) + 0
as.numeric(a > b)
diag(2*as.numeric(a > b) - 1 )
acPCAcv
library(acPCA)
data(data_example1)
X <- data_example1$X ###the data matrix
dim(X)
Y <- data_example1$Y ###the confounder matrix
acPCAcv
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=1, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
detach("package:acPCA", unload=TRUE)
vS <- array(runif(10*400), dim=c(10, 400, 1))
dim(vS)
llab <- 5
apply(abs(vS[llab, ,] - v), 2, sum)
v <- matrix(runif(400), ncol=1)
dim(v)
dim(vS[llab, ,])
dim(vS)
vS[4,,]
vS <- array(runif(10*400), dim=c(10, 400, 2))
dim(vS[1,,])
dim(v)
dim(v*2)
library(acPCA)
data(data_example1)
X <- data_example1$X ###the data matrix
dim(X)
Y <- data_example1$Y ###the confounder matrix
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=1, plot=T) ###
result_cv$loss
result_cv <- acPCAcv(X=X, Y=Y, lambdas=seq(0, 1, 0.05), kernel="linear", nPC=2, plot=T) ###
library(devtools)
library(roxygen2)
setwd("/Users/zhixianglin/AC-PCA/R_package/acPCA/")
document()
setwd("/Users/zhixianglin/AC-PCA/R_package/")
install("acPCA")
acPCAcv
